-- // Midnight Chasers Pro Farm GUI // Grimoire Edition üßô‚Äç‚ôÇÔ∏è //
-- Full rewrite with smooth GUI & optimizations
-- Written for Roblox Lua (Executor compatible)

--// SERVICES //
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

--// GLOBAL SETTINGS //
getgenv().AutoFarm = false
getgenv().AutoDeliver = false
getgenv().Speed = 250
getgenv().CancelTween = nil
getgenv().GroundPart = nil

--// ANTI-AFK //
LocalPlayer.Idled:Connect(function()
    local vu = game:GetService("VirtualUser")
    vu:CaptureController()
    vu:ClickButton2(Vector2.new())
end)
warn("Anti-AFK Enabled")

--// HELPER FUNCTIONS //
local function ensureGroundPart()
    if not getgenv().GroundPart then
        local ground = Instance.new("Part", workspace)
        ground.Name = "_AutoFarmGround"
        ground.Anchored = true
        ground.Size = Vector3.new(10000, 10, 10000)
        ground.Position = Vector3.new(0, -50, 0)
        ground.Color = Color3.fromRGB(20, 20, 20)
        getgenv().GroundPart = ground
    end
end

local function hideWorkspaceObjects()
    local folder = ReplicatedStorage:FindFirstChild("mrbackupfolder") or Instance.new("Folder", ReplicatedStorage)
    folder.Name = "mrbackupfolder"
    for _, obj in ipairs(workspace:GetChildren()) do
        if obj:IsA("Model") or obj:IsA("Folder") or obj:IsA("MeshPart") then
            if not string.find(obj.Name, LocalPlayer.Name) and not string.find(obj.Name, "Gift") and obj.Name ~= "" then
                obj.Parent = folder
            end
        end
    end
end

local function restoreWorkspaceObjects()
    local folder = ReplicatedStorage:FindFirstChild("mrbackupfolder")
    if folder then
        for _, v in ipairs(folder:GetChildren()) do
            v.Parent = workspace
            task.wait()
        end
    end
end

--// TWEENING LOGIC //
local function tweenToPosition(car, targetPos, speed)
    ensureGroundPart()
    local TweenInfoToUse = TweenInfo.new((car.PrimaryPart.Position - targetPos.Position).Magnitude / speed, Enum.EasingStyle.Linear)
    local CValue = Instance.new("CFrameValue")
    CValue.Value = car:GetPrimaryPartCFrame()

    CValue.Changed:Connect(function()
        local pos = CValue.Value.Position
        getgenv().GroundPart.Position = pos - Vector3.new(0, 14, 0)
        car:PivotTo(CFrame.new(getgenv().GroundPart.Position + Vector3.new(0, 7, 0), targetPos.Position))
        car.PrimaryPart.AssemblyLinearVelocity = car.PrimaryPart.CFrame.LookVector * speed
    end)

    local Tween = TweenService:Create(CValue, TweenInfoToUse, { Value = targetPos })
    getgenv().CurrentTween = Tween
    Tween:Play()
    repeat task.wait() until Tween.PlaybackState ~= Enum.PlaybackState.Playing
end

--// GUI CREATION //
local ScreenGui = Instance.new("ScreenGui", LocalPlayer:WaitForChild("PlayerGui"))
ScreenGui.Name = "MidnightFarmUI"
ScreenGui.ResetOnSpawn = false

local MainFrame = Instance.new("Frame", ScreenGui)
MainFrame.Size = UDim2.new(0, 300, 0, 240)
MainFrame.Position = UDim2.new(0.5, -150, 0.5, -120)
MainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
MainFrame.BorderSizePixel = 0
MainFrame.Active = true
MainFrame.Draggable = true

local UICorner = Instance.new("UICorner", MainFrame)
UICorner.CornerRadius = UDim.new(0, 12)

local UIStroke = Instance.new("UIStroke", MainFrame)
UIStroke.Thickness = 2
UIStroke.Color = Color3.fromRGB(100, 0, 200)

local Title = Instance.new("TextLabel", MainFrame)
Title.Size = UDim2.new(1, 0, 0, 40)
Title.BackgroundTransparency = 1
Title.Text = "üåô Midnight Chasers"
Title.Font = Enum.Font.GothamBold
Title.TextColor3 = Color3.fromRGB(180, 140, 255)
Title.TextScaled = true

local ScrollingFrame = Instance.new("ScrollingFrame", MainFrame)
ScrollingFrame.Size = UDim2.new(1, 0, 1, -40)
ScrollingFrame.Position = UDim2.new(0, 0, 0, 40)
ScrollingFrame.CanvasSize = UDim2.new(0, 0, 2, 0)
ScrollingFrame.ScrollBarThickness = 6
ScrollingFrame.BackgroundTransparency = 1

local function createToggle(text, callback)
    local Btn = Instance.new("TextButton", ScrollingFrame)
    Btn.Size = UDim2.new(1, -20, 0, 36)
    Btn.Position = UDim2.new(0, 10, 0, (#ScrollingFrame:GetChildren() - 1) * 40)
    Btn.Text = text
    Btn.Font = Enum.Font.Gotham
    Btn.TextSize = 16
    Btn.BackgroundColor3 = Color3.fromRGB(50, 50, 80)
    Btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    Btn.AutoButtonColor = true

    local UIC = Instance.new("UICorner", Btn)
    UIC.CornerRadius = UDim.new(0, 10)

    local On = false
    Btn.MouseButton1Click:Connect(function()
        On = not On
        Btn.BackgroundColor3 = On and Color3.fromRGB(100, 0, 200) or Color3.fromRGB(50, 50, 80)
        callback(On)
    end)
end

-- GUI TOGGLES
createToggle("Auto Farm", function(state)
    getgenv().AutoFarm = state
    if state then
        hideWorkspaceObjects()
    else
        restoreWorkspaceObjects()
    end
end)

createToggle("Auto Deliver", function(state)
    getgenv().AutoDeliver = state
    if state then
        hideWorkspaceObjects()
    else
        restoreWorkspaceObjects()
    end
end)

-- Add speed slider (simple text input)
local SpeedBox = Instance.new("TextBox", ScrollingFrame)
SpeedBox.PlaceholderText = "Vehicle Speed"
SpeedBox.Size = UDim2.new(1, -20, 0, 36)
SpeedBox.Position = UDim2.new(0, 10, 0, (#ScrollingFrame:GetChildren() - 1) * 40)
SpeedBox.BackgroundColor3 = Color3.fromRGB(40, 40, 60)
SpeedBox.TextColor3 = Color3.new(1, 1, 1)
SpeedBox.Font = Enum.Font.Gotham
SpeedBox.TextSize = 16
SpeedBox.Text = tostring(getgenv().Speed)
local BoxCorner = Instance.new("UICorner", SpeedBox)

SpeedBox.FocusLost:Connect(function()
    local val = tonumber(SpeedBox.Text)
    if val then
        getgenv().Speed = val
    end
end)

-- UI TOGGLE KEYBIND
local UIS = game:GetService("UserInputService")
UIS.InputBegan:Connect(function(input)
    if input.KeyCode == Enum.KeyCode.RightShift then
        ScreenGui.Enabled = not ScreenGui.Enabled
    end
end)

warn("üåô Midnight Chasers GUI Loaded Successfully!")
